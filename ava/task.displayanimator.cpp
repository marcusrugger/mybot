#include "task.displayanimator.h"


const uint16_t animation_count = 20;
const uint8_t animation[][4] =
{
    { 0b00000000, 0b00000000, 0b00000000, 0b00000010 },
    { 0b00000000, 0b00000000, 0b00000000, 0b00000001 },
    { 0b00000000, 0b00000000, 0b00000001, 0b00000000 },
    { 0b00000000, 0b00000001, 0b00000000, 0b00000000 },
    { 0b00000001, 0b00000000, 0b00000000, 0b00000000 },
    { 0b00100000, 0b00000000, 0b00000000, 0b00000000 },

    { 0b01000000, 0b00000000, 0b00000000, 0b00000000 },
    { 0b00000000, 0b01000000, 0b00000000, 0b00000000 },
    { 0b00000000, 0b00000000, 0b01000000, 0b00000000 },
    { 0b00000000, 0b00000000, 0b00000000, 0b01000000 },

    { 0b00000000, 0b00000000, 0b00000000, 0b00000100 },
    { 0b00000000, 0b00000000, 0b00000000, 0b00001000 },
    { 0b00000000, 0b00000000, 0b00001000, 0b00000000 },
    { 0b00000000, 0b00001000, 0b00000000, 0b00000000 },
    { 0b00001000, 0b00000000, 0b00000000, 0b00000000 },
    { 0b00010000, 0b00000000, 0b00000000, 0b00000000 },

    { 0b01000000, 0b00000000, 0b00000000, 0b00000000 },
    { 0b00000000, 0b01000000, 0b00000000, 0b00000000 },
    { 0b00000000, 0b00000000, 0b01000000, 0b00000000 },
    { 0b00000000, 0b00000000, 0b00000000, 0b01000000 },


    // { 0b00010000, 0b00000000, 0b00000000, 0b00000000 },
    // { 0b00001000, 0b00000000, 0b00000000, 0b00000000 },
    // { 0b00000000, 0b00001000, 0b00000000, 0b00000000 },
    // { 0b00000000, 0b00000000, 0b00001000, 0b00000000 },
    // { 0b00000000, 0b00000000, 0b00000000, 0b00001000 },
    // { 0b00000000, 0b00000000, 0b00000000, 0b00000100 },
    // { 0b00000000, 0b00000000, 0b00000000, 0b00000010 }
};


DisplayAnimatorTask *DisplayAnimatorTask::create(DataSerializer *writer)
{
    return new DisplayAnimatorTask(writer);
}


DisplayAnimatorTask::DisplayAnimatorTask(DataSerializer *writer)
:   _writer(writer),
    _animation_index(0)
{}


void DisplayAnimatorTask::run(void)
{
    _writer->writeData(animation[_animation_index++], 4);
    _animation_index %= animation_count;
}
